{"meta":{"title":"Hexo","subtitle":"","description":"","author":"John Doe","url":"http://example.com","root":"/"},"pages":[{"title":"About","date":"2025-08-11T20:07:15.961Z","updated":"2025-08-11T20:07:15.961Z","comments":true,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":""},{"title":"Categories","date":"2025-08-11T20:07:15.962Z","updated":"2025-08-11T20:07:15.961Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"Tags","date":"2025-08-11T20:07:15.962Z","updated":"2025-08-11T20:07:15.962Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"YOLOv3 model.pyä»£ç çš„ç®€å•åˆ†ææ³¨è§£","slug":"Yoloå­¦ä¹ /YOLOv3","date":"2025-08-20T13:01:27.000Z","updated":"2025-08-24T20:20:50.000Z","comments":true,"path":"wiki/Yoloå­¦ä¹ /YOLOv3/","permalink":"http://example.com/wiki/Yolo%E5%AD%A6%E4%B9%A0/YOLOv3/","excerpt":"","text":"YOLOv3 model.pyä»£ç çš„ç®€å•åˆ†ææ³¨è§£&gt; å‡†å¤‡12345678910from functools import wrapsimport numpy as npimport tensorflow as tffrom keras import backend as Kfrom keras.layers import Conv2D, Add, ZeroPadding2D, UpSampling2D, Concatenate, MaxPooling2Dfrom keras.layers.advanced_activations import LeakyReLUfrom keras.layers.normalization import BatchNormalizationfrom keras.models import Modelfrom keras.regularizers import l2from yolo3.utils import compose &gt; YOLOç½‘ç»œé¦–å…ˆè¦é€šè¿‡ç‰¹å¾æå–ç½‘ç»œå¯¹è¾“å…¥çš„è¾“å…¥å›¾åƒæå–ç‰¹å¾ï¼Œå¾—åˆ°ä¸åŒå°ºå¯¸çš„ç‰¹å¾å›¾### ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374@wraps(Conv2D)#@wrapsåœ¨æ­¤å¤„çš„ä½œç”¨æ˜¯ä¸ºäº†ä½¿DarknetConv2D.__name__å’ŒDarknetConv2D.__doc__ä¸Conv2D__name__å’ŒConv2D.__doc__ç›¸åŒã€‚def DarknetConv2D(*args, **kwargs): &quot;&quot;&quot;Wrapper to set Darknet parameters for Convolution2D.&quot;&quot;&quot; darknet_conv_kwargs = &#123;&#x27;kernel_regularizer&#x27;: l2(5e-4)&#125; darknet_conv_kwargs[&#x27;padding&#x27;] = &#x27;valid&#x27; if kwargs.get(&#x27;strides&#x27;)==(2,2) else &#x27;same&#x27; darknet_conv_kwargs.update(kwargs) return Conv2D(*args, **darknet_conv_kwargs)def DarknetConv2D_BN_Leaky(*args, **kwargs): &quot;&quot;&quot;Darknet Convolution2D followed by BatchNormalization and LeakyReLU.&quot;&quot;&quot; no_bias_kwargs = &#123;&#x27;use_bias&#x27;: False&#125; no_bias_kwargs.update(kwargs) return compose( DarknetConv2D(*args, **no_bias_kwargs), BatchNormalization(), LeakyReLU(alpha=0.1))def resblock_body(x, num_filters, num_blocks): &#x27;&#x27;&#x27;A series of resblocks starting with a downsampling Convolution2D&#x27;&#x27;&#x27; # Darknet uses left and top padding instead of &#x27;same&#x27; mode x = ZeroPadding2D(((1,0),(1,0)))(x)#((top_pad,bottom_pad),(left_pad,right_pad)) è¿™é‡Œçš„ZeroPadding2Dæ˜¯ä¸ºç´§è·Ÿç€çš„DBLæœåŠ¡çš„ï¼Œä½¿å…¶å°ºå¯¸æ­£å¥½ç¼©å°ä¸ºåŸæ¥çš„ä¸€åŠ x = DarknetConv2D_BN_Leaky(num_filters, (3,3), strides=(2,2))(x) for i in range(num_blocks): y = compose( DarknetConv2D_BN_Leaky(num_filters//2, (1,1)), DarknetConv2D_BN_Leaky(num_filters, (3,3)))(x) x = Add()([x,y]) return xdef darknet_body(x): &#x27;&#x27;&#x27;Darknent body having 52 Convolution2D layers&#x27;&#x27;&#x27; x = DarknetConv2D_BN_Leaky(32, (3,3))(x) x = resblock_body(x, 64, 1) x = resblock_body(x, 128, 2) x = resblock_body(x, 256, 8) x = resblock_body(x, 512, 8) x = resblock_body(x, 1024, 4) return xdef make_last_layers(x, num_filters, out_filters): &#x27;&#x27;&#x27;6 Conv2D_BN_Leaky layers followed by a Conv2D_linear layer&#x27;&#x27;&#x27; x = compose( DarknetConv2D_BN_Leaky(num_filters, (1,1)), DarknetConv2D_BN_Leaky(num_filters*2, (3,3)), DarknetConv2D_BN_Leaky(num_filters, (1,1)), DarknetConv2D_BN_Leaky(num_filters*2, (3,3)), DarknetConv2D_BN_Leaky(num_filters, (1,1)))(x) y = compose( DarknetConv2D_BN_Leaky(num_filters*2, (3,3)), DarknetConv2D(out_filters, (1,1)))(x) return x, ydef yolo_body(inputs, num_anchors, num_classes): &quot;&quot;&quot;Create YOLO_V3 model CNN body in Keras.&quot;&quot;&quot; darknet = Model(inputs, darknet_body(inputs)) #ç¬¬ä¸€ä¸ªç‰¹å¾å±‚y1=(batch_size,13,13,3,85) x, y1 = make_last_layers(darknet.output, 512, num_anchors*(num_classes+5)) x = compose( DarknetConv2D_BN_Leaky(256, (1,1)), UpSampling2D(2))(x) x = Concatenate()([x,darknet.layers[152].output])#darknet.layers[152].output]#è¿™é‡Œçš„[152]ä¸­çš„æ•°å­—ä¸ºå¯¹åº”å±‚æ•° #ç¬¬äºŒä¸ªç‰¹å¾å±‚y2=(batch_size,26,26,3,85) x, y2 = make_last_layers(x, 256, num_anchors*(num_classes+5)) x = compose( DarknetConv2D_BN_Leaky(128, (1,1)), UpSampling2D(2))(x) x = Concatenate()([x,darknet.layers[92].output]) #ç¬¬ä¸‰ä¸ªç‰¹å¾å±‚y3=(batch_size,52,52,3,85) x, y3 = make_last_layers(x, 128, num_anchors*(num_classes+5)) return Model(inputs, [y1,y2,y3]) æµç¨‹å›¾ æ•´ä¸ªyolov3ç½‘ç»œå…±252å±‚&gt; tiny_yolo_bodyè½»é‡ç‰ˆçš„YOLO,æœ‰é€Ÿåº¦å¿«ï¼Œå å†…å­˜å°‘ç­‰çš„ä¼˜ç‚¹ï¼Œè§†æƒ…å†µé€‰æ‹©ä½¿ç”¨ã€‚12345678910111213141516171819202122232425262728293031def tiny_yolo_body(inputs, num_anchors, num_classes): &#x27;&#x27;&#x27;Create Tiny YOLO_v3 model CNN body in keras.&#x27;&#x27;&#x27; x1 = compose( DarknetConv2D_BN_Leaky(16, (3,3)), MaxPooling2D(pool_size=(2,2), strides=(2,2), padding=&#x27;same&#x27;), DarknetConv2D_BN_Leaky(32, (3,3)), MaxPooling2D(pool_size=(2,2), strides=(2,2), padding=&#x27;same&#x27;), DarknetConv2D_BN_Leaky(64, (3,3)), MaxPooling2D(pool_size=(2,2), strides=(2,2), padding=&#x27;same&#x27;), DarknetConv2D_BN_Leaky(128, (3,3)), MaxPooling2D(pool_size=(2,2), strides=(2,2), padding=&#x27;same&#x27;), DarknetConv2D_BN_Leaky(256, (3,3)))(inputs) x2 = compose( MaxPooling2D(pool_size=(2,2), strides=(2,2), padding=&#x27;same&#x27;), DarknetConv2D_BN_Leaky(512, (3,3)), MaxPooling2D(pool_size=(2,2), strides=(1,1), padding=&#x27;same&#x27;), DarknetConv2D_BN_Leaky(1024, (3,3)), DarknetConv2D_BN_Leaky(256, (1,1)))(x1) y1 = compose( DarknetConv2D_BN_Leaky(512, (3,3)), DarknetConv2D(num_anchors*(num_classes+5), (1,1)))(x2) x2 = compose( DarknetConv2D_BN_Leaky(128, (1,1)), UpSampling2D(2))(x2) y2 = compose( Concatenate(), DarknetConv2D_BN_Leaky(256, (3,3)), DarknetConv2D(num_anchors*(num_classes+5), (1,1)))([x2,x1]) return Model(inputs, [y1,y2]) &gt; é¢„æµ‹æ¡†çš„è·å¾—1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768#å°†é¢„æµ‹å€¼çš„æ¯ä¸ªç‰¹å¾å±‚è°ƒæˆçœŸå®å€¼def yolo_head(feats, anchors, num_classes, input_shape, calc_loss=False): &quot;&quot;&quot;Convert final layer features to bounding box parameters.&quot;&quot;&quot; num_anchors = len(anchors)#num_anchors=3 # Reshape to batch, height, width, num_anchors, box_params. anchors_tensor = K.reshape(K.constant(anchors), [1, 1, 1, num_anchors, 2]) grid_shape = K.shape(feats)[1:3] # height, width grid_y = K.tile(K.reshape(K.arange(0, stop=grid_shape[0]), [-1, 1, 1, 1]), [1, grid_shape[1], 1, 1])#å°†xåœ¨å„ä¸ªç»´åº¦ä¸Šé‡å¤næ¬¡ï¼Œxä¸ºå¼ é‡ï¼Œnä¸ºä¸xç»´åº¦æ•°ç›®ç›¸åŒçš„åˆ—è¡¨ grid_x = K.tile(K.reshape(K.arange(0, stop=grid_shape[1]), [1, -1, 1, 1]), [grid_shape[0], 1, 1, 1]) grid = K.concatenate([grid_x, grid_y])#ä»å€’æ•°ç¬¬1ä¸ªç»´åº¦è¿›è¡Œæ‹¼æ¥,å¯è§†ä¸ºå¾—åˆ°æ¯ä¸ªå•å…ƒæ ¼å·¦ä¸Šè§’çš„åæ ‡ grid = K.cast(grid, K.dtype(feats)) feats = K.reshape( feats, [-1, grid_shape[0], grid_shape[1], num_anchors, num_classes + 5])#(batch_size,13,13,3,85) # Adjust preditions to each spatial grid point and anchor size. #box_xyå¯¹åº”æ¡†çš„ä¸­å¿ƒç‚¹ï¼Œbox_whå¯¹åº”æ¡†çš„å®½å’Œé«˜ box_xy = (K.sigmoid(feats[..., :2]) + grid) / K.cast(grid_shape[::-1], K.dtype(feats))#grid ä¸ºåç§» ï¼Œå°†x,yç›¸å¯¹äºfeaturemapå°ºå¯¸è¿›è¡Œäº†å½’ä¸€åŒ– box_wh = K.exp(feats[..., 2:4]) * anchors_tensor / K.cast(input_shape[::-1], K.dtype(feats))#exp() æ–¹æ³•è¿”å›xçš„æŒ‡æ•°,exã€‚ box_confidence = K.sigmoid(feats[..., 4:5])#ç½®ä¿¡ç‡ box_class_probs = K.sigmoid(feats[..., 5:])#80ä¸ªç±»åˆ« #åœ¨è®¡ç®—lossçš„æ—¶å€™è¿”å›ä»¥ä¸‹å‚æ•° if calc_loss == True: return grid, feats, box_xy, box_wh return box_xy, box_wh, box_confidence, box_class_probs#å¯¹boxè¿›è¡Œè°ƒæ•´ï¼Œä½¿å…¶ç¬¦åˆçœŸå®å›¾ç‰‡çš„æ ·å­def yolo_correct_boxes(box_xy, box_wh, input_shape, image_shape): &#x27;&#x27;&#x27;Get corrected boxes&#x27;&#x27;&#x27; box_yx = box_xy[..., ::-1] box_hw = box_wh[..., ::-1] input_shape = K.cast(input_shape, K.dtype(box_yx)) image_shape = K.cast(image_shape, K.dtype(box_yx)) #è¿™é‡ŒK.minå–è¾ƒå°å€¼ï¼Œä¾¿äºåç»­æ­¥éª¤è°ƒæ•´é€‚åº”imageçš„å°ºå¯¸ï¼Œnewæ˜¯imageç­‰æ¯”ç¼©å°å¾—æ¥ new_shape = K.round(image_shape * K.min(input_shape/image_shape))#K.round()åº•å±‚å³ä¸ºtf.round(),Bankers Roundingâ€”â€”å››èˆå…­å…¥äº”å–å¶,å¦‚4.5â€”â€”&gt;4;3.5â€”â€”&gt;4 offset = (input_shape-new_shape)/2./input_shape scale = input_shape/new_shape box_yx = (box_yx - offset) * scale box_hw *= scale box_mins = box_yx - (box_hw / 2.) box_maxes = box_yx + (box_hw / 2.) boxes = K.concatenate([ box_mins[..., 0:1], # y_min box_mins[..., 1:2], # x_min box_maxes[..., 0:1], # y_max box_maxes[..., 1:2] # x_max ])#ï¼ˆx_min,y_min),ï¼ˆx_max,y_max)åˆ†åˆ«ä¸ºå·¦ä¸Šï¼Œå³ä¸‹ç‚¹çš„åæ ‡ # Scale boxes back to original image shape. boxes *= K.concatenate([image_shape, image_shape]) return boxes#è·å–æ¯ä¸ªboxå’Œå®ƒçš„å¾—åˆ†def yolo_boxes_and_scores(feats, anchors, num_classes, input_shape, image_shape): &#x27;&#x27;&#x27;Process Conv layer output&#x27;&#x27;&#x27; # -1,13,13,3,2;-1,13,13,3,2;-1,13,13,3,1;-1,13,13,3,80; box_xy, box_wh, box_confidence, box_class_probs = yolo_head(feats, anchors, num_classes, input_shape) #å°†box_xy,box_whè°ƒèŠ‚æˆy_min,y_max,x_min,x_max boxes = yolo_correct_boxes(box_xy, box_wh, input_shape, image_shape) boxes = K.reshape(boxes, [-1, 4]) box_scores = box_confidence * box_class_probs box_scores = K.reshape(box_scores, [-1, num_classes]) return boxes, box_scores æ±‚å¾—bx,by,bw,bhçš„å…¬å¼ &gt; å¯»æ‰¾æœ€ä½³çš„anchor box12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485def preprocess_true_boxes(true_boxes, input_shape, anchors, num_classes): &#x27;&#x27;&#x27;Preprocess true boxes to training input format Parameters ---------- true_boxes: array, shape=(m, T, 5) Absolute x_min, y_min, x_max, y_max, class_id relative to input_shape. input_shape: array-like, hw, multiples of 32 anchors: array, shape=(N, 2), wh num_classes: integer Returns ------- y_true: list of array, shape like yolo_outputs, xywh are reletive value &#x27;&#x27;&#x27; assert (true_boxes[..., 4]&lt;num_classes).all(), &#x27;class id must be less than num_classes&#x27; #assertï¼ˆæ–­è¨€ï¼‰ç”¨äºåˆ¤æ–­ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œåœ¨è¡¨è¾¾å¼æ¡ä»¶ä¸º false çš„æ—¶å€™è§¦å‘å¼‚å¸¸ã€‚ #.allï¼ˆï¼‰æµ‹è¯•æ²¿ç»™å®šè½´çš„æ‰€æœ‰æ•°ç»„å…ƒç´ æ˜¯å¦éƒ½è®¡ç®—ä¸ºTrueã€‚å…ƒç´ é™¤äº†æ˜¯ 0ã€ç©ºã€Noneã€False å¤–éƒ½ç®— True num_layers = len(anchors)//3 # default setting # å…ˆéªŒæ¡† # 678ä¸º116ï¼Œ90ï¼›156ï¼Œ198ï¼›373ï¼Œ326 # 345ä¸º30ï¼Œ61ï¼›62ï¼Œ45ï¼›59ï¼Œ119 # 012ä¸º10ï¼Œ13ï¼›16ï¼Œ30ï¼›33ï¼Œ23 anchor_mask = [[6,7,8], [3,4,5], [0,1,2]] if num_layers==3 else [[3,4,5], [1,2,3]] true_boxes = np.array(true_boxes, dtype=&#x27;float32&#x27;) input_shape = np.array(input_shape, dtype=&#x27;int32&#x27;) #å°†è¾¹æ¡†çš„ä¸¤ç‚¹åæ ‡å½¢å¼ï¼Œè½¬åŒ–æˆè®­ç»ƒçš„ä¸­å¿ƒåŠ è¾¹é•¿å½¢å¼ï¼Œå¹¶è¿›è¡Œå½’ä¸€åŒ– boxes_xy = (true_boxes[..., 0:2] + true_boxes[..., 2:4]) // 2 boxes_wh = true_boxes[..., 2:4] - true_boxes[..., 0:2] true_boxes[..., 0:2] = boxes_xy/input_shape[::-1] true_boxes[..., 2:4] = boxes_wh/input_shape[::-1] m = true_boxes.shape[0]#må¼ å›¾ç‰‡ grid_shapes = [input_shape//&#123;0:32, 1:16, 2:8&#125;[l] for l in range(num_layers)] #y_trueçš„æ ¼å¼ä¸ºï¼ˆm,13,13,3,85),(m,26,26,3,85),(m,52,52,3,85) num_classesæ˜¯ä¸€ä¸ªone_hotç¼–ç  y_true = [np.zeros((m,grid_shapes[l][0],grid_shapes[l][1],len(anchor_mask[l]),5+num_classes), dtype=&#x27;float32&#x27;) for l in range(num_layers)] # Expand dim to apply broadcasting.å¢åŠ ç»´åº¦æ˜¯ä¸ºäº†æ›´å¥½çš„è®¡ç®— anchors = np.expand_dims(anchors, 0)#np.expand_dims(input, dim, name=None)å‡½æ•°,å°†ç»´åº¦åŠ 1 #anchor/2å’Œå–ååˆ™æ˜¯ä¸ºäº†è®¡ç®—iou å¯ä»¥çœ‹ä½œæŠŠanchorçš„ä¸­å¿ƒç§»åˆ°åæ ‡åŸç‚¹ anchor_maxes = anchors / 2. anchor_mins = -anchor_maxes #é•¿åº¦è¦å¤§äº0æ‰æœ‰æ•ˆ valid_mask = boxes_wh[..., 0]&gt;0 for b in range(m): # Discard zero rows. wh = boxes_wh[b, valid_mask[b]] if len(wh)==0: continue # Expand dim to apply broadcasting. wh = np.expand_dims(wh, -2) box_maxes = wh / 2. box_mins = -box_maxes #è®¡ç®—çœŸå®æ¡†å’Œå“ªä¸ªå…ˆéªŒæ¡†æœ€å¥‘åˆã€å¯¹äºæœ‰æ•ˆçš„è¾¹æ¡†ã€é‡‡ç”¨ä¸anchorç›¸ä¼¼çš„å¤„ç†æ–¹æ³• #INTERSECTï¼ˆäº¤é›†) é›†åˆè¿ç®— intersect_mins = np.maximum(box_mins, anchor_mins) intersect_maxes = np.minimum(box_maxes, anchor_maxes) intersect_wh = np.maximum(intersect_maxes - intersect_mins, 0.) intersect_area = intersect_wh[..., 0] * intersect_wh[..., 1] box_area = wh[..., 0] * wh[..., 1] anchor_area = anchors[..., 0] * anchors[..., 1] iou = intersect_area / (box_area + anchor_area - intersect_area) # Find best anchor for each true box best_anchor = np.argmax(iou, axis=-1)#np.argmax()è¿”å›å¼ é‡æ²¿æŒ‡å®šç»´åº¦æœ€å¤§å€¼çš„å¼•ç´¢ for t, n in enumerate(best_anchor):#enumerate()æ˜¯pythonçš„å†…ç½®å‡½æ•°ï¼Œå¯éå†æ¯ä¸ªå…ƒç´ ï¼Œç»„åˆä¸ºç´¢å¼• å…ƒç´ ï¼Œå¸¸åœ¨forå¾ªç¯ä¸­ä½¿ç”¨ for l in range(num_layers): if n in anchor_mask[l]: #np.floor()è¿”å›ä¸å¤§äºè¾“å…¥å‚æ•°çš„æœ€å¤§æ•´æ•°ã€‚ï¼ˆå‘ä¸‹å–æ•´ï¼‰ i = np.floor(true_boxes[b,t,0]*grid_shapes[l][1]).astype(&#x27;int32&#x27;)#ä¸­å¿ƒç‚¹xåœ¨gridä¸­çš„å¯¹åº”ä½ç½® j = np.floor(true_boxes[b,t,1]*grid_shapes[l][0]).astype(&#x27;int32&#x27;) k = anchor_mask[l](n)#è¿”å›çœŸå®æ¡†å¯¹åº”æœ€å¥‘åˆçš„å…ˆéªŒæ¡†ä¸­ c = true_boxes[b,t, 4].astype(&#x27;int32&#x27;)#è¯¥æ¡†æ‰€å¯¹åº”çš„ç±»åˆ« #å°†çœŸå®æ¡†çš„ä¿¡æ¯æ”¾è¿›y_trueä¸ä¹‹å¯¹åº”çš„ç‰¹å¾å±‚çš„ç›¸å¯¹åº”ä¸­å¿ƒç‚¹ä¸­ y_true[l][b, j, i, k, 0:4] = true_boxes[b,t, 0:4] y_true[l][b, j, i, k, 4] = 1 y_true[l][b, j, i, k, 5+c] = 1 return y_true preprocess_true_boxesä¸­æ¶‰åŠåˆ°çš„anchor boxå’Œground truthç»è¿‡&#x2F;2å’Œå–åç­‰å¤„ç†åï¼Œå…¶ç›¸å¯¹å…³ç³»åº”å¤§æ¦‚å¦‚å›¾æ‰€ç¤ºï¼š &gt; LOSSå€¼çš„è®¡ç®—ï¼ˆ1ï¼‰è®¡ç®—xyï¼ˆç‰©ä½“ä¸­å¿ƒåæ ‡ï¼‰çš„æŸå¤±ï¼šxyloss&#x3D;bool*(2-areaPred)*bceï¼ˆ2ï¼‰è®¡ç®—whï¼ˆanchoré•¿å®½å›å½’å€¼ï¼‰çš„æŸå¤±ï¼šwhloss&#x3D;bool*(2-areaPred)*bceï¼ˆ3ï¼‰è®¡ç®—ç½®ä¿¡åº¦çš„æŸå¤±ï¼šwhloss&#x3D;bool*(2-areaPred)*bceï¼ˆ4ï¼‰è®¡ç®—ç±»åˆ«æŸå¤±ï¼šç½®ä¿¡åº¦ä¹˜ä¸Šå¤šåˆ†ç±»çš„äº¤å‰ç†µ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129#å®šä¹‰ä¸€ä¸ªiouå‡½æ•°def box_iou(b1, b2): &#x27;&#x27;&#x27;Return iou tensor Parameters ---------- b1: tensor, shape=(i1,...,iN, 4), xywh b2: tensor, shape=(j, 4), xywh Returns ------- iou: tensor, shape=(i1,...,iN, j) &#x27;&#x27;&#x27; # Expand dim to apply broadcasting. b1 = K.expand_dims(b1, -2) b1_xy = b1[..., :2] b1_wh = b1[..., 2:4] b1_wh_half = b1_wh/2. b1_mins = b1_xy - b1_wh_half b1_maxes = b1_xy + b1_wh_half # Expand dim to apply broadcasting. b2 = K.expand_dims(b2, 0) b2_xy = b2[..., :2] b2_wh = b2[..., 2:4] b2_wh_half = b2_wh/2. b2_mins = b2_xy - b2_wh_half b2_maxes = b2_xy + b2_wh_half intersect_mins = K.maximum(b1_mins, b2_mins) intersect_maxes = K.minimum(b1_maxes, b2_maxes) intersect_wh = K.maximum(intersect_maxes - intersect_mins, 0.) intersect_area = intersect_wh[..., 0] * intersect_wh[..., 1] b1_area = b1_wh[..., 0] * b1_wh[..., 1] b2_area = b2_wh[..., 0] * b2_wh[..., 1] iou = intersect_area / (b1_area + b2_area - intersect_area) return ioudef yolo_loss(args, anchors, num_classes, ignore_thresh=.5, print_loss=False): &#x27;&#x27;&#x27;Return yolo_loss tensor Parameters ---------- yolo_outputs: list of tensor, the output of yolo_body or tiny_yolo_body y_true: list of array, the output of preprocess_true_boxes anchors: array, shape=(N, 2), wh num_classes: integer ignore_thresh: float, the iou threshold whether to ignore object confidence loss Returns ------- loss: tensor, shape=(1,) &#x27;&#x27;&#x27; num_layers = len(anchors)//3 # default setting #å°†é¢„æµ‹ç»“æœå’Œå®é™…ground truthåˆ†å¼€ï¼Œargsæ˜¯[*model_body.output,*y_true] #y_trueæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«ä¸‰ä¸ªç‰¹å¾å±‚ï¼Œshapeåˆ†åˆ«ä¸º(m,13,13,3,85),(m,26,26,3,85),(m,52,52,3,85) #yolo_outputsæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«ä¸‰ä¸ªç‰¹å¾å±‚ï¼Œshapeåˆ†åˆ«ä¸º(m,13,13,3,85),(m,26,26,3,85),(m,52,52,3,85) yolo_outputs = args[:num_layers] y_true = args[num_layers:] anchor_mask = [[6,7,8], [3,4,5], [0,1,2]] if num_layers==3 else [[3,4,5], [1,2,3]] input_shape = K.cast(K.shape(yolo_outputs[0])[1:3] * 32, K.dtype(y_true[0])) grid_shapes = [K.cast(K.shape(yolo_outputs[l])[1:3], K.dtype(y_true[0])) for l in range(num_layers)] loss = 0 m = K.shape(yolo_outputs[0])[0] # batch size, tensor mf = K.cast(m, K.dtype(yolo_outputs[0])) for l in range(num_layers): #å–å‡ºå…¶å¯¹åº”çš„ç§ç±»(m,X,X,3,1) object_mask = y_true[l][..., 4:5]#obiect_maskå°±æ˜¯ç½®ä¿¡åº¦ #å–å‡ºå…¶å¯¹åº”çš„ç§ç±»(m,X,X,3,80) true_class_probs = y_true[l][..., 5:] #å°†yolo_outputsçš„ç‰¹å¾å±‚è¾“å‡ºè¿›è¡Œå¤„ç† #gridä¸ºç½‘æ ¼ç»“æ„(x,x,1,2),raw_predä¸ºå°šæœªå¤„ç†çš„é¢„æµ‹ç»“æœ(m,x,x,3,85) #è¿˜æœ‰è§£ç åçš„xyï¼Œwhï¼Œ(m,13,13,3,2) grid, raw_pred, pred_xy, pred_wh = yolo_head(yolo_outputs[l], anchors[anchor_mask[l]], num_classes, input_shape, calc_loss=True) #è§£ç åçš„é¢„æµ‹çš„boxçš„ä½ç½® #(m,13,13,3,4) pred_box = K.concatenate([pred_xy, pred_wh]) # Darknet raw box to calculate loss. raw_true_xy = y_true[l][..., :2]*grid_shapes[l][::-1] - grid raw_true_wh = K.log(y_true[l][..., 2:4] / anchors[anchor_mask[l]] * input_shape[::-1]) raw_true_wh = K.switch(object_mask, raw_true_wh, K.zeros_like(raw_true_wh)) # avoid log(0)=-inf#switchæ¥å£ï¼Œå°±æ˜¯ä¸€ä¸ªif/elseæ¡ä»¶åˆ¤æ–­è¯­å¥ box_loss_scale = 2 - y_true[l][...,2:3]*y_true[l][...,3:4] # Find ignore mask, iterate over each of batch. ignore_mask = tf.TensorArray(K.dtype(y_true[0]), size=1, dynamic_size=True) object_mask_bool = K.cast(object_mask, &#x27;bool&#x27;) def loop_body(b, ignore_mask): true_box = tf.boolean_mask(y_true[l][b,...,0:4], object_mask_bool[b,...,0]) #è®¡ç®—é¢„æµ‹ç»“æœä¸çœŸå®æƒ…å†µçš„iou #pred_boxä¸º13ï¼Œ13ï¼Œ3ï¼Œ4 #è®¡ç®—çš„ç»“æœæ˜¯æ¯ä¸ªpred_boxå’Œå…¶å®ƒæ‰€æœ‰çœŸå®æ¡†çš„iou #13ï¼Œ13ï¼Œ3ï¼Œn iou = box_iou(pred_box[b], true_box) best_iou = K.max(iou, axis=-1) ignore_mask = ignore_mask.write(b, K.cast(best_iou&lt;ignore_thresh, K.dtype(true_box))) return b+1, ignore_mask #éå†æ‰€æœ‰å›¾ç‰‡ _, ignore_mask = K.control_flow_ops.while_loop(lambda b,*args: b&lt;m, loop_body, [0, ignore_mask])#K.control_flow_ops.while_loop(cond, body, loop_vars)ï¼Œå…¶ä¸­condæ˜¯æ¡ä»¶åˆ¤æ–­å‡½æ•°ï¼Œè¿”å›Trueæˆ–False; bodyæ˜¯å¾ªç¯ä½“ï¼›loop_varsæ˜¯ä¼ å…¥condå’Œbodyçš„å‚æ•°åˆ—è¡¨ã€‚ #å°†æ¯å¹…å›¾çš„å†…å®¹å‹ç¼©ï¼Œè¿›è¡Œå¤„ç† ignore_mask = ignore_mask.stack() #(m,13,13,3,1,1) ignore_mask = K.expand_dims(ignore_mask, -1) # K.binary_crossentropy is helpful to avoid exp overflow. xy_loss = object_mask * box_loss_scale * K.binary_crossentropy(raw_true_xy, raw_pred[...,0:2], from_logits=True) wh_loss = object_mask * box_loss_scale * 0.5 * K.square(raw_true_wh-raw_pred[...,2:4]) #å¦‚æœè¯¥ä½ç½®æœ¬æ¥æœ‰æ¡†ï¼Œé‚£ä¹ˆè®¡ç®—1ä¸ç½®ä¿¡åº¦çš„äº¤å‰ç†µ #å¦‚æœè¯¥ä½ç½®æœ¬æ¥æ²¡æœ‰æ¡†ï¼Œè€Œä¸”æ»¡è¶³best_iou&lt;ignore_threshï¼Œåˆ™è¢«è®¤å®šä¸ºè´Ÿæ ·æœ¬ #best_iou&lt;ignore_threshç”¨äºé™åˆ¶è´Ÿæ ·æœ¬ confidence_loss = object_mask * K.binary_crossentropy(object_mask, raw_pred[...,4:5], from_logits=True) (1-object_mask) * K.binary_crossentropy(object_mask, raw_pred[...,4:5], from_logits=True) * ignore_mask class_loss = object_mask * K.binary_crossentropy(true_class_probs, raw_pred[...,5:], from_logits=True) xy_loss = K.sum(xy_loss) / mf wh_loss = K.sum(wh_loss) / mf confidence_loss = K.sum(confidence_loss) / mf class_loss = K.sum(class_loss) / mf loss += xy_loss + wh_loss + confidence_loss + class_loss if print_loss: loss = tf.Print(loss, [loss, xy_loss, wh_loss, confidence_loss, class_loss, K.sum(ignore_mask)], message=&#x27;loss: &#x27;) return loss åœ¨losså€¼çš„è®¡ç®—è¿‡ç¨‹ä¸­é¢„æµ‹æ¡†è¢«åˆ†ä¸ºä¸‰ç±»ï¼šæ­£ä¾‹ï¼šä»»å–ä¸€ä¸ªground truthï¼Œä¸4032ä¸ªæ¡†å…¨éƒ¨è®¡ç®—IOUï¼ŒIOUæœ€å¤§çš„é¢„æµ‹æ¡†ï¼Œå³ä¸ºæ­£ä¾‹ã€‚å¹¶ä¸”ä¸€ä¸ªé¢„æµ‹æ¡†ï¼Œåªèƒ½åˆ†é…ç»™ä¸€ä¸ªground truthã€‚ä¾‹å¦‚ç¬¬ä¸€ä¸ªground truthå·²ç»åŒ¹é…äº†ä¸€ä¸ªæ­£ä¾‹æ£€æµ‹æ¡†ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªground truthï¼Œå°±åœ¨ä½™ä¸‹çš„4031ä¸ªæ£€æµ‹æ¡†ä¸­ï¼Œå¯»æ‰¾IOUæœ€å¤§çš„æ£€æµ‹æ¡†ä½œä¸ºæ­£ä¾‹ã€‚ground truthçš„å…ˆåé¡ºåºå¯å¿½ç•¥ã€‚æ­£ä¾‹äº§ç”Ÿç½®ä¿¡åº¦lossã€æ£€æµ‹æ¡†lossã€ç±»åˆ«lossã€‚é¢„æµ‹æ¡†ä¸ºå¯¹åº”çš„ground truth boxæ ‡ç­¾ï¼ˆéœ€è¦åå‘ç¼–ç ï¼Œä½¿ç”¨çœŸå®çš„xã€yã€wã€hè®¡ç®—å‡º [å…¬å¼] ï¼‰ï¼›ç±»åˆ«æ ‡ç­¾å¯¹åº”ç±»åˆ«ä¸º1ï¼Œå…¶ä½™ä¸º0ï¼›ç½®ä¿¡åº¦æ ‡ç­¾ä¸º1ã€‚å¿½ç•¥æ ·ä¾‹ï¼šæ­£ä¾‹é™¤å¤–ï¼Œä¸ä»»æ„ä¸€ä¸ªground truthçš„IOUå¤§äºé˜ˆå€¼ï¼ˆè®ºæ–‡ä¸­ä½¿ç”¨0.5ï¼‰ï¼Œåˆ™ä¸ºå¿½ç•¥æ ·ä¾‹ã€‚å¿½ç•¥æ ·ä¾‹ä¸äº§ç”Ÿä»»ä½•lossã€‚ï¼ˆå­˜åœ¨æ„ä¹‰ï¼šç”±äºYolov3ä½¿ç”¨äº†å¤šå°ºåº¦ç‰¹å¾å›¾ï¼Œä¸åŒå°ºåº¦çš„ç‰¹å¾å›¾ä¹‹é—´ä¼šæœ‰é‡åˆæ£€æµ‹éƒ¨åˆ†ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªçœŸå®ç‰©ä½“ï¼Œåœ¨è®­ç»ƒæ—¶è¢«åˆ†é…åˆ°çš„æ£€æµ‹æ¡†æ˜¯ç‰¹å¾å›¾1çš„ç¬¬ä¸‰ä¸ªboxï¼ŒIOUè¾¾0.98ï¼Œæ­¤æ—¶æ°å¥½ç‰¹å¾å›¾2çš„ç¬¬ä¸€ä¸ªboxä¸è¯¥ground truthçš„IOUè¾¾0.95ï¼Œä¹Ÿæ£€æµ‹åˆ°äº†è¯¥ground truthï¼Œå¦‚æœæ­¤æ—¶ç»™å…¶ç½®ä¿¡åº¦å¼ºè¡Œæ‰“0çš„æ ‡ç­¾ï¼Œç½‘ç»œå­¦ä¹ æ•ˆæœä¼šä¸ç†æƒ³ã€‚ï¼‰è´Ÿä¾‹ï¼šæ­£ä¾‹é™¤å¤–ï¼ˆä¸ground truthè®¡ç®—åIOUæœ€å¤§çš„æ£€æµ‹æ¡†ï¼Œä½†æ˜¯IOUå°äºé˜ˆå€¼ï¼Œä»ä¸ºæ­£ä¾‹ï¼‰ï¼Œä¸å…¨éƒ¨ground truthçš„IOUéƒ½å°äºé˜ˆå€¼ï¼ˆ0.5ï¼‰ï¼Œåˆ™ä¸ºè´Ÿä¾‹ã€‚è´Ÿä¾‹åªæœ‰ç½®ä¿¡åº¦äº§ç”Ÿlossï¼Œç½®ä¿¡åº¦æ ‡ç­¾ä¸º0ã€‚&gt; å›¾ç‰‡é¢„æµ‹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253def yolo_eval(yolo_outputs, anchors, num_classes, image_shape, max_boxes=20, score_threshold=.6, iou_threshold=.5): &quot;&quot;&quot;Evaluate YOLO model on given input and return filtered boxes.&quot;&quot;&quot; #è·å¾—ç‰¹å¾å±‚çš„æ•°é‡ num_layers = len(yolo_outputs) #ç‰¹å¾å±‚1å¯¹åº”çš„anchoræ˜¯678 #ç‰¹å¾å±‚2å¯¹åº”çš„anchoræ˜¯345 #ç‰¹å¾å±‚3å¯¹åº”çš„anchoræ˜¯012 anchor_mask = [[6,7,8], [3,4,5], [0,1,2]] if num_layers==3 else [[3,4,5], [1,2,3]] # default setting input_shape = K.shape(yolo_outputs[0])[1:3] * 32 boxes = [] box_scores = [] #å¯¹æ¯ä¸ªç‰¹å¾å±‚è¿›è¡Œå¤„ç† for l in range(num_layers): _boxes, _box_scores = yolo_boxes_and_scores(yolo_outputs[l], anchors[anchor_mask[l]], num_classes, input_shape, image_shape) boxes.append(_boxes) box_scores.append(_box_scores) #å°†æ¯ä¸ªç‰¹å¾å±‚ç»“æœè¿›è¡Œå †å  boxes = K.concatenate(boxes, axis=0) box_scores = K.concatenate(box_scores, axis=0) mask = box_scores &gt;= score_threshold max_boxes_tensor = K.constant(max_boxes, dtype=&#x27;int32&#x27;) boxes_ = [] scores_ = [] classes_ = [] for c in range(num_classes): # TODO: use keras backend instead of tf. #å–å‡ºæ‰€æœ‰box_scores&gt;=score_thresholdçš„æ¡†å’Œæˆç»© class_boxes = tf.boolean_mask(boxes, mask[:, c])#tf.boolean_mask çš„ä½œç”¨æ˜¯ é€šè¿‡å¸ƒå°”å€¼ è¿‡æ»¤å…ƒç´ tensorï¼šè¢«è¿‡æ»¤çš„å…ƒç´ maskï¼šä¸€å † bool å€¼ï¼Œå®ƒçš„ç»´åº¦ä¸ä¸€å®šç­‰äº tensorreturnï¼š mask ä¸º true å¯¹åº”çš„ tensor çš„å…ƒç´ å½“ tensor ä¸ mask ç»´åº¦ä¸€è‡´æ—¶ï¼Œreturn ä¸€ç»´ class_box_scores = tf.boolean_mask(box_scores[:, c], mask[:, c]) #éæå¤§æŠ‘åˆ¶ nms_index = tf.image.non_max_suppression( class_boxes, class_box_scores, max_boxes_tensor, iou_threshold=iou_threshold) #è·å¾—éæå¤§å€¼æŠ‘åˆ¶åçš„ç»“æœ #ä¸‹åˆ—ä¸‰ä¸ªåˆ†åˆ«æ˜¯ï¼šæ¡†çš„ä½ç½®ï¼Œå¾—åˆ†ä¸ç§ç±» class_boxes = K.gather(class_boxes, nms_index) class_box_scores = K.gather(class_box_scores, nms_index)#gatherï¼ˆreference,indices)åœ¨ç»™å®šçš„å¼ é‡ä¸­æœç´¢ç»™å®šä¸‹æ ‡çš„å‘é‡ã€‚ classes = K.ones_like(class_box_scores, &#x27;int32&#x27;) * c#ones_likeç»™å®šä¸€ä¸ªtensorï¼ˆtensor å‚æ•°ï¼‰ï¼Œè¯¥æ“ä½œè¿”å›ä¸€ä¸ªå…·æœ‰å’Œç»™å®štensorç›¸åŒå½¢çŠ¶ï¼ˆshapeï¼‰å’Œç›¸åŒæ•°æ®ç±»å‹ï¼ˆdtypeï¼‰ï¼Œä½†æ˜¯æ‰€æœ‰çš„å…ƒç´ éƒ½è¢«è®¾ç½®ä¸º1çš„tensorã€‚ boxes_.append(class_boxes) scores_.append(class_box_scores) classes_.append(classes) boxes_ = K.concatenate(boxes_, axis=0) scores_ = K.concatenate(scores_, axis=0) classes_ = K.concatenate(classes_, axis=0) return boxes_, scores_, classes_","categories":[{"name":"Yoloå­¦ä¹ ","slug":"Yoloå­¦ä¹ ","permalink":"http://example.com/categories/Yolo%E5%AD%A6%E4%B9%A0/"}],"tags":[]},{"title":"yolov2åšå‡ºçš„æ”¹è¿›","slug":"Yoloå­¦ä¹ /yolov2åšå‡ºçš„æ”¹è¿›","date":"2025-08-15T08:34:27.000Z","updated":"2025-08-24T20:16:56.000Z","comments":true,"path":"wiki/Yoloå­¦ä¹ /yolov2åšå‡ºçš„æ”¹è¿›/","permalink":"http://example.com/wiki/Yolo%E5%AD%A6%E4%B9%A0/yolov2%E5%81%9A%E5%87%BA%E7%9A%84%E6%94%B9%E8%BF%9B/","excerpt":"","text":"yolov1çš„ç¼ºç‚¹YOLOv1è™½ç„¶æ£€æµ‹é€Ÿåº¦å¾ˆå¿«ï¼Œä½†æ˜¯åœ¨æ£€æµ‹ç²¾åº¦ä¸Šå´ä¸å¦‚R-CNNç³»æ£€æµ‹æ–¹æ³•ï¼ŒYOLOv1åœ¨ç‰©ä½“å®šä½æ–¹é¢ï¼ˆlocalizationï¼‰ä¸å¤Ÿå‡†ç¡®ï¼Œå¹¶ä¸”å¬å›ç‡ï¼ˆrecallï¼‰è¾ƒä½ã€‚ è§£å†³æ–¹æ³•1.Batch NormalizaBatch Normalizationå¯ä»¥æå‡æ¨¡å‹æ”¶æ•›é€Ÿåº¦ï¼Œè€Œä¸”å¯ä»¥èµ·åˆ°ä¸€å®šæ­£åˆ™åŒ–æ•ˆæœï¼Œé™ä½æ¨¡å‹çš„è¿‡æ‹Ÿåˆã€‚åœ¨YOLOv2ä¸­ï¼Œæ¯ä¸ªå·ç§¯å±‚åé¢éƒ½æ·»åŠ äº†Batch Normalizationå±‚ï¼Œå¹¶ä¸”ä¸å†ä½¿ç”¨droputã€‚ä½¿ç”¨Batch Normalizationåï¼ŒYOLOv2çš„mAPæå‡äº†2.4%ã€‚ 2.High Resolution Classifierç”¨æ›´é«˜åˆ†è¾¨ç‡çš„è¾“å…¥ï¼ˆ448x448ï¼‰ä¹‹å‰æ˜¯ï¼ˆ224x224ï¼‰ã€‚ 3.Convolutional With Anchor Boxesä»¥å‰ yolo1å­˜åœ¨çš„é—®é¢˜åœ¨YOLOv1ä¸­ï¼Œè¾“å…¥å›¾ç‰‡æœ€ç»ˆè¢«åˆ’åˆ†ä¸º$7\\times 7$ ç½‘æ ¼ï¼Œæ¯ä¸ªå•å…ƒæ ¼é¢„æµ‹2ä¸ªè¾¹ç•Œæ¡†ã€‚YOLOv1æœ€åé‡‡ç”¨çš„æ˜¯å…¨è¿æ¥å±‚ç›´æ¥å¯¹è¾¹ç•Œæ¡†è¿›è¡Œé¢„æµ‹ï¼Œå…¶ä¸­è¾¹ç•Œæ¡†çš„å®½ä¸é«˜æ˜¯ç›¸å¯¹æ•´å¼ å›¾ç‰‡å¤§å°çš„ï¼Œè€Œç”±äºå„ä¸ªå›¾ç‰‡ä¸­å­˜åœ¨ä¸åŒå°ºåº¦å’Œé•¿å®½æ¯”ï¼ˆscales and ratios)çš„ç‰©ä½“ï¼ŒYOLOv1åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å­¦ä¹ é€‚åº”ä¸åŒç‰©ä½“çš„å½¢çŠ¶æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œè¿™ä¹Ÿå¯¼è‡´YOLOv1åœ¨ç²¾ç¡®å®šä½æ–¹é¢è¡¨ç°è¾ƒå·®ã€‚ æ”¹è¿›æ€è·¯ç”¨anchor boxesï¼ˆå…ˆéªŒæ¡†ï¼‰ é‡‡ç”¨å…ˆéªŒæ¡†ä½¿å¾—æ¨¡å‹æ›´å®¹æ˜“å­¦ä¹ ã€‚æ‰€ä»¥YOLOv2ç§»é™¤äº†YOLOv1ä¸­çš„å…¨è¿æ¥å±‚è€Œé‡‡ç”¨äº†å·ç§¯å’Œanchor boxesæ¥é¢„æµ‹è¾¹ç•Œæ¡†ã€‚ æ•ˆæœä½¿ç”¨anchor boxesä¹‹åï¼ŒYOLOv2çš„mAPæœ‰ç¨å¾®ä¸‹é™ï¼ˆè¿™é‡Œä¸‹é™çš„åŸå› ï¼Œæˆ‘çŒœæƒ³æ˜¯YOLOv2è™½ç„¶ä½¿ç”¨äº†anchor boxesï¼Œä½†æ˜¯ä¾ç„¶é‡‡ç”¨YOLOv1çš„è®­ç»ƒæ–¹æ³•ï¼‰ã€‚YOLOv1åªèƒ½é¢„æµ‹98ä¸ªè¾¹ç•Œæ¡†ï¼ˆ ï¼‰ï¼Œè€ŒYOLOv2ä½¿ç”¨anchor boxesä¹‹åå¯ä»¥é¢„æµ‹ä¸Šåƒä¸ªè¾¹ç•Œæ¡†ï¼ˆ )ã€‚æ‰€ä»¥ä½¿ç”¨anchor boxesä¹‹åï¼ŒYOLOv2çš„å¬å›ç‡å¤§å¤§æå‡ï¼Œç”±åŸæ¥çš„81%å‡è‡³88%ã€‚ 4.Dimension Clusterså…ˆéªŒæ¡†çš„ç»´åº¦ï¼ˆé•¿å’Œå®½ï¼‰éƒ½æ˜¯æ‰‹åŠ¨è®¾å®šçš„ï¼Œå¸¦æœ‰ä¸€å®šçš„ä¸»è§‚æ€§ã€‚å¦‚æœé€‰å–çš„å…ˆéªŒæ¡†ç»´åº¦æ¯”è¾ƒåˆé€‚ï¼Œé‚£ä¹ˆæ¨¡å‹æ›´å®¹æ˜“å­¦ä¹ ï¼Œä»è€Œåšå‡ºæ›´å¥½çš„é¢„æµ‹ã€‚å› æ­¤ï¼ŒYOLOv2é‡‡ç”¨k-meansèšç±»æ–¹æ³•å¯¹è®­ç»ƒé›†ä¸­çš„è¾¹ç•Œæ¡†åšäº†èšç±»åˆ†æã€‚ èšç±»åˆ†ææ€ä¹ˆåšçš„æˆ‘è¿˜æ²¡æœ‰çœ‹ å› ä¸ºè®¾ç½®å…ˆéªŒæ¡†çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ä½¿å¾—é¢„æµ‹æ¡†ä¸ground truthçš„IOUæ›´å¥½ï¼Œæ‰€ä»¥èšç±»åˆ†ææ—¶é€‰ç”¨boxä¸èšç±»ä¸­å¿ƒboxä¹‹é—´çš„IOUå€¼ä½œä¸ºè·ç¦»æŒ‡æ ‡ï¼š 5.New Network: Darknet-19YOLOv2é‡‡ç”¨äº†ä¸€ä¸ªæ–°çš„åŸºç¡€æ¨¡å‹ï¼ˆç‰¹å¾æå–å™¨ï¼‰ï¼Œç§°ä¸ºDarknet-19ï¼ŒåŒ…æ‹¬19ä¸ªå·ç§¯å±‚å’Œ5ä¸ªmaxpoolingå±‚ï¼Œå¦‚å›¾4æ‰€ç¤ºã€‚Darknet-19ä¸VGG16æ¨¡å‹è®¾è®¡åŸåˆ™æ˜¯ä¸€è‡´çš„ï¼Œä¸»è¦é‡‡ç”¨ å·ç§¯ï¼Œé‡‡ç”¨ çš„maxpoolingå±‚ä¹‹åï¼Œç‰¹å¾å›¾ç»´åº¦é™ä½2å€ï¼Œè€ŒåŒæ—¶å°†ç‰¹å¾å›¾çš„channleså¢åŠ ä¸¤å€ã€‚ä¸NIN(Network in Network)ç±»ä¼¼ï¼ŒDarknet-19æœ€ç»ˆé‡‡ç”¨global avgpoolingåšé¢„æµ‹ï¼Œå¹¶ä¸”åœ¨ å·ç§¯ä¹‹é—´ä½¿ç”¨ å·ç§¯æ¥å‹ç¼©ç‰¹å¾å›¾channlesä»¥é™ä½æ¨¡å‹è®¡ç®—é‡å’Œå‚æ•°ã€‚Darknet-19æ¯ä¸ªå·ç§¯å±‚åé¢åŒæ ·ä½¿ç”¨äº†batch normå±‚ä»¥åŠ å¿«æ”¶æ•›é€Ÿåº¦ï¼Œé™ä½æ¨¡å‹è¿‡æ‹Ÿåˆã€‚ æ€§èƒ½æå‡åœ¨ImageNetåˆ†ç±»æ•°æ®é›†ä¸Šï¼ŒDarknet-19çš„top-1å‡†ç¡®åº¦ä¸º72.9%ï¼Œtop-5å‡†ç¡®åº¦ä¸º91.2%ï¼Œä½†æ˜¯æ¨¡å‹å‚æ•°ç›¸å¯¹å°ä¸€äº›ã€‚ä½¿ç”¨Darknet-19ä¹‹åï¼ŒYOLOv2çš„mAPå€¼æ²¡æœ‰æ˜¾è‘—æå‡ï¼Œä½†æ˜¯è®¡ç®—é‡å´å¯ä»¥å‡å°‘çº¦33%ã€‚ 6.Direct location predictionå‰é¢è®²åˆ°ï¼ŒYOLOv2å€Ÿé‰´RPNç½‘ç»œä½¿ç”¨anchor boxesæ¥é¢„æµ‹è¾¹ç•Œæ¡†ç›¸å¯¹å…ˆéªŒæ¡†çš„offsetsã€‚è¾¹ç•Œæ¡†çš„å®é™…ä¸­å¿ƒä½ç½® ï¼Œéœ€è¦æ ¹æ®é¢„æµ‹çš„åæ ‡åç§»å€¼ ï¼Œå…ˆéªŒæ¡†çš„å°ºåº¦ ä»¥åŠä¸­å¿ƒåæ ‡ ï¼ˆç‰¹å¾å›¾æ¯ä¸ªä½ç½®çš„ä¸­å¿ƒç‚¹ï¼‰æ¥è®¡ç®—ï¼š ä½†æ˜¯ä¸Šé¢çš„å…¬å¼æ˜¯æ— çº¦æŸçš„ï¼Œé¢„æµ‹çš„è¾¹ç•Œæ¡†å¾ˆå®¹æ˜“å‘ä»»ä½•æ–¹å‘åç§»ï¼Œå¦‚å½“ æ—¶è¾¹ç•Œæ¡†å°†å‘å³åç§»å…ˆéªŒæ¡†çš„ä¸€ä¸ªå®½åº¦å¤§å°ï¼Œè€Œå½“ æ—¶è¾¹ç•Œæ¡†å°†å‘å·¦åç§»å…ˆéªŒæ¡†çš„ä¸€ä¸ªå®½åº¦å¤§å°ï¼Œå› æ­¤æ¯ä¸ªä½ç½®é¢„æµ‹çš„è¾¹ç•Œæ¡†å¯ä»¥è½åœ¨å›¾ç‰‡ä»»ä½•ä½ç½®ï¼Œè¿™å¯¼è‡´æ¨¡å‹çš„ä¸ç¨³å®šæ€§ï¼Œåœ¨è®­ç»ƒæ—¶éœ€è¦å¾ˆé•¿æ—¶é—´æ¥é¢„æµ‹å‡ºæ­£ç¡®çš„offsetsã€‚ æ‰€ä»¥ï¼ŒYOLOv2å¼ƒç”¨äº†è¿™ç§é¢„æµ‹æ–¹å¼ï¼Œè€Œæ˜¯æ²¿ç”¨YOLOv1çš„æ–¹æ³•ï¼Œå°±æ˜¯é¢„æµ‹è¾¹ç•Œæ¡†ä¸­å¿ƒç‚¹ç›¸å¯¹äºå¯¹åº”cellå·¦ä¸Šè§’ä½ç½®çš„ç›¸å¯¹åç§»å€¼ï¼Œä¸ºäº†å°†è¾¹ç•Œæ¡†ä¸­å¿ƒç‚¹çº¦æŸåœ¨å½“å‰cellä¸­ï¼Œä½¿ç”¨sigmoidå‡½æ•°å¤„ç†åç§»å€¼ï¼Œè¿™æ ·é¢„æµ‹çš„åç§»å€¼åœ¨(0,1)èŒƒå›´å†…ï¼ˆæ¯ä¸ªcellçš„å°ºåº¦çœ‹åš1ï¼‰ã€‚æ€»ç»“æ¥çœ‹ï¼Œæ ¹æ®è¾¹ç•Œæ¡†é¢„æµ‹çš„4ä¸ªoffsets ï¼Œå¯ä»¥æŒ‰å¦‚ä¸‹å…¬å¼è®¡ç®—å‡ºè¾¹ç•Œæ¡†å®é™…ä½ç½®å’Œå¤§å°ï¼š å…¶ä¸­ ä¸ºcellçš„å·¦ä¸Šè§’åæ ‡ï¼Œå¦‚å›¾5æ‰€ç¤ºï¼Œåœ¨è®¡ç®—æ—¶æ¯ä¸ªcellçš„å°ºåº¦ä¸º1ï¼Œæ‰€ä»¥å½“å‰cellçš„å·¦ä¸Šè§’åæ ‡ä¸º ã€‚ç”±äºsigmoidå‡½æ•°çš„å¤„ç†ï¼Œè¾¹ç•Œæ¡†çš„ä¸­å¿ƒä½ç½®ä¼šçº¦æŸåœ¨å½“å‰cellå†…éƒ¨ï¼Œé˜²æ­¢åç§»è¿‡å¤šã€‚è€Œ å’Œ æ˜¯å…ˆéªŒæ¡†çš„å®½åº¦ä¸é•¿åº¦ï¼Œå‰é¢è¯´è¿‡å®ƒä»¬çš„å€¼ä¹Ÿæ˜¯ç›¸å¯¹äºç‰¹å¾å›¾å¤§å°çš„ï¼Œåœ¨ç‰¹å¾å›¾ä¸­æ¯ä¸ªcellçš„é•¿å’Œå®½å‡ä¸º1ã€‚è¿™é‡Œè®°ç‰¹å¾å›¾çš„å¤§å°ä¸º ï¼ˆåœ¨æ–‡ä¸­æ˜¯ )ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å°†è¾¹ç•Œæ¡†ç›¸å¯¹äºæ•´å¼ å›¾ç‰‡çš„ä½ç½®å’Œå¤§å°è®¡ç®—å‡ºæ¥ï¼ˆ4ä¸ªå€¼å‡åœ¨0å’Œ1ä¹‹é—´ï¼‰ï¼š å¦‚æœå†å°†ä¸Šé¢çš„4ä¸ªå€¼åˆ†åˆ«ä¹˜ä»¥å›¾ç‰‡çš„å®½åº¦å’Œé•¿åº¦ï¼ˆåƒç´ ç‚¹å€¼ï¼‰å°±å¯ä»¥å¾—åˆ°è¾¹ç•Œæ¡†çš„æœ€ç»ˆä½ç½®å’Œå¤§å°äº†ã€‚è¿™å°±æ˜¯YOLOv2è¾¹ç•Œæ¡†çš„æ•´ä¸ªè§£ç è¿‡ç¨‹ã€‚çº¦æŸäº†è¾¹ç•Œæ¡†çš„ä½ç½®é¢„æµ‹å€¼ä½¿å¾—æ¨¡å‹æ›´å®¹æ˜“ç¨³å®šè®­ç»ƒï¼Œç»“åˆèšç±»åˆ†æå¾—åˆ°å…ˆéªŒæ¡†ä¸è¿™ç§é¢„æµ‹æ–¹æ³•ï¼ŒYOLOv2çš„mAPå€¼æå‡äº†çº¦5%ã€‚ 7.Fine-Grained FeaturesYOLOv2çš„è¾“å…¥å›¾ç‰‡å¤§å°ä¸º$416\\times 416$ ï¼Œç»è¿‡5æ¬¡maxpoolingä¹‹åå¾—åˆ°$13\\times 13$å¤§å°çš„ç‰¹å¾å›¾ï¼Œå¹¶ä»¥æ­¤ç‰¹å¾å›¾é‡‡ç”¨å·ç§¯åšé¢„æµ‹ã€‚ å¤§å°çš„ç‰¹å¾å›¾å¯¹æ£€æµ‹å¤§ç‰©ä½“æ˜¯è¶³å¤Ÿäº†ï¼Œä½†æ˜¯å¯¹äºå°ç‰©ä½“è¿˜éœ€è¦æ›´ç²¾ç»†çš„ç‰¹å¾å›¾ï¼ˆFine-Grained Features)ã€‚ YOLOv2æ‰€åˆ©ç”¨çš„Fine-Grained Featuresæ˜¯ å¤§å°çš„ç‰¹å¾å›¾ï¼ˆæœ€åä¸€ä¸ªmaxpoolingå±‚çš„è¾“å…¥ï¼‰ï¼Œå¯¹äºDarknet-19æ¨¡å‹æ¥è¯´å°±æ˜¯å¤§å°ä¸º çš„ç‰¹å¾å›¾ã€‚passthroughå±‚ä¸ResNetç½‘ç»œçš„shortcutç±»ä¼¼ï¼Œä»¥å‰é¢æ›´é«˜åˆ†è¾¨ç‡çš„ç‰¹å¾å›¾ä¸ºè¾“å…¥ï¼Œç„¶åå°†å…¶è¿æ¥åˆ°åé¢çš„ä½åˆ†è¾¨ç‡ç‰¹å¾å›¾ä¸Šã€‚å‰é¢çš„ç‰¹å¾å›¾ç»´åº¦æ˜¯åé¢çš„ç‰¹å¾å›¾çš„2å€ï¼Œpassthroughå±‚æŠ½å–å‰é¢å±‚çš„æ¯ä¸ª çš„å±€éƒ¨åŒºåŸŸï¼Œç„¶åå°†å…¶è½¬åŒ–ä¸ºchannelç»´åº¦ï¼Œå¯¹äº çš„ç‰¹å¾å›¾ï¼Œç»passthroughå±‚å¤„ç†ä¹‹åå°±å˜æˆäº† çš„æ–°ç‰¹å¾å›¾ï¼ˆç‰¹å¾å›¾å¤§å°é™ä½4å€ï¼Œè€Œchannleså¢åŠ 4å€ï¼Œå›¾6ä¸ºä¸€ä¸ªå®ä¾‹ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥ä¸åé¢çš„ ç‰¹å¾å›¾è¿æ¥åœ¨ä¸€èµ·å½¢æˆ å¤§å°çš„ç‰¹å¾å›¾ï¼Œç„¶ååœ¨æ­¤ç‰¹å¾å›¾åŸºç¡€ä¸Šå·ç§¯åšé¢„æµ‹ã€‚ å¦å¤–ï¼Œä½œè€…åœ¨åæœŸçš„å®ç°ä¸­å€Ÿé‰´äº†ResNetç½‘ç»œï¼Œä¸æ˜¯ç›´æ¥å¯¹é«˜åˆ†è¾¨ç‰¹å¾å›¾å¤„ç†ï¼Œè€Œæ˜¯å¢åŠ äº†ä¸€ä¸ªä¸­é—´å·ç§¯å±‚ï¼Œå…ˆé‡‡ç”¨64ä¸ª å·ç§¯æ ¸è¿›è¡Œå·ç§¯ï¼Œç„¶åå†è¿›è¡Œpassthroughå¤„ç†ï¼Œè¿™æ · çš„ç‰¹å¾å›¾å¾—åˆ° çš„ç‰¹å¾å›¾ã€‚è¿™ç®—æ˜¯å®ç°ä¸Šçš„ä¸€ä¸ªå°ç»†èŠ‚ã€‚ä½¿ç”¨Fine-Grained Featuresä¹‹åYOLOv2çš„æ€§èƒ½æœ‰1%çš„æå‡ã€‚ 8.Multi-Scale Trainingç”±äºYOLOv2æ¨¡å‹ä¸­åªæœ‰å·ç§¯å±‚å’Œæ± åŒ–å±‚ï¼Œæ‰€ä»¥YOLOv2çš„è¾“å…¥å¯ä»¥ä¸é™äº å¤§å°çš„å›¾ç‰‡ã€‚ä¸ºäº†å¢å¼ºæ¨¡å‹çš„é²æ£’æ€§ï¼ŒYOLOv2é‡‡ç”¨äº†å¤šå°ºåº¦è¾“å…¥è®­ç»ƒç­–ç•¥ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ¯é—´éš”ä¸€å®šçš„iterationsä¹‹åæ”¹å˜æ¨¡å‹çš„è¾“å…¥å›¾ç‰‡å¤§å°ã€‚ ç”±äºYOLOv2çš„ä¸‹é‡‡æ ·æ€»æ­¥é•¿ä¸º32ï¼Œè¾“å…¥å›¾ç‰‡å¤§å°é€‰æ‹©ä¸€ç³»åˆ—ä¸º32å€æ•°çš„å€¼ï¼š ï¼Œè¾“å…¥å›¾ç‰‡æœ€å°ä¸º ï¼Œæ­¤æ—¶å¯¹åº”çš„ç‰¹å¾å›¾å¤§å°ä¸º ï¼ˆä¸æ˜¯å¥‡æ•°äº†ï¼Œç¡®å®æœ‰ç‚¹å°´å°¬ï¼‰ï¼Œè€Œè¾“å…¥å›¾ç‰‡æœ€å¤§ä¸º ï¼Œå¯¹åº”çš„ç‰¹å¾å›¾å¤§å°ä¸º ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ï¼Œæ¯éš”10ä¸ªiterationséšæœºé€‰æ‹©ä¸€ç§è¾“å…¥å›¾ç‰‡å¤§å°ï¼Œç„¶ååªéœ€è¦ä¿®æ”¹å¯¹æœ€åæ£€æµ‹å±‚çš„å¤„ç†å°±å¯ä»¥é‡æ–°è®­ç»ƒã€‚","categories":[{"name":"Yoloå­¦ä¹ ","slug":"Yoloå­¦ä¹ ","permalink":"http://example.com/categories/Yolo%E5%AD%A6%E4%B9%A0/"}],"tags":[]},{"title":"yolo1 æ€æƒ³ä¸è¾“å‡ºçš„å½¢å¼","slug":"Yoloå­¦ä¹ /yolo1 æ€æƒ³ä¸è¾“å‡ºçš„å½¢å¼","date":"2025-08-13T10:34:27.000Z","updated":"2025-08-24T20:06:06.000Z","comments":true,"path":"wiki/Yoloå­¦ä¹ /yolo1 æ€æƒ³ä¸è¾“å‡ºçš„å½¢å¼/","permalink":"http://example.com/wiki/Yolo%E5%AD%A6%E4%B9%A0/yolo1%20%E6%80%9D%E6%83%B3%E4%B8%8E%E8%BE%93%E5%87%BA%E7%9A%84%E5%BD%A2%E5%BC%8F/","excerpt":"","text":"åªè¯´ç»“è®ºyolo1 å°†ä¸€å¼ å›¾ç‰‡åˆ†å‰²ä¸ºS*Sä¸ªå•å…ƒæ ¼ï¼Œæ¯ä¸ªå•å…ƒæ ¼è¾“å‡ºï¼ˆBx5+Cï¼‰ä¸ªå€¼ã€‚ è§£é‡Šï¼š Bï¼šæ¯ä¸ªå•å…ƒæ ¼å°†ä¼šé¢„æµ‹Bä¸ªè¾¹æ¡†ã€‚ï¼ˆå°±æ˜¯åœˆBä¸ªæ¡†æ¡†ï¼‰ 5ï¼šæ¯ä¸ªåœˆå‡ºæ¥çš„æ¡†æ¡†æœ‰5ä¸ªå‚æ•° ï¼Œå…¶ä¸­å‰å››ä¸ªæ˜¯ç›¸å¯¹äºå•å…ƒæ ¼çš„æ¯”ä¾‹ï¼ˆå°±æ˜¯0åˆ°1ä¹‹é—´çš„æ•°)ã€‚cä»£è¡¨è¯¥å•å…ƒæ ¼çš„ç½®ä¿¡åº¦ã€‚ç”¨è¯¥å•å…ƒæ ¼å«æœ‰ç›®æ ‡çš„æ¦‚ç‡ä¸å‡†ç¡®åº¦çš„ä¹˜ç§¯è¡¨ç¤ºã€‚ C: one-hotç¼–ç çš„å±äºCä¸ªç±»åˆ«çš„é¢„æµ‹å€¼ã€‚ æ‰€æœ‰å•å…ƒæ ¼çš„å°±æ˜¯S*Sï¼ˆBx5+Cï¼‰ä¸ªå€¼ éæå¤§å€¼æŠ‘åˆ¶ç®—æ³•ï¼ˆnon maximum suppression, NMSï¼‰è¿™ä¸ªç®—æ³•ä¸å•å•æ˜¯é’ˆå¯¹Yoloç®—æ³•çš„ï¼Œè€Œæ˜¯æ‰€æœ‰çš„æ£€æµ‹ç®—æ³•ä¸­éƒ½ä¼šç”¨åˆ°ã€‚NMSç®—æ³•ä¸»è¦è§£å†³çš„æ˜¯ä¸€ä¸ªç›®æ ‡è¢«å¤šæ¬¡æ£€æµ‹çš„é—®é¢˜ï¼Œå¦‚äººè„¸æ£€æµ‹ï¼Œå¯ä»¥çœ‹åˆ°äººè„¸è¢«å¤šæ¬¡æ£€æµ‹ï¼Œä½†æ˜¯å…¶å®æˆ‘ä»¬å¸Œæœ›æœ€åä»…ä»…è¾“å‡ºå…¶ä¸­ä¸€ä¸ªæœ€å¥½çš„é¢„æµ‹æ¡†ã€‚ é¦–å…ˆä»æ‰€æœ‰çš„æ£€æµ‹æ¡†ä¸­æ‰¾åˆ°ç½®ä¿¡åº¦æœ€å¤§çš„é‚£ä¸ªæ¡†ï¼Œç„¶åæŒ¨ä¸ªè®¡ç®—å…¶ä¸å‰©ä½™æ¡†çš„IOUï¼ˆä¸ªäººç†è§£ä¸ºé‡åˆåŒºåŸŸæ¯”ä¾‹ï¼‰ï¼Œå¦‚æœå…¶å€¼å¤§äºä¸€å®šé˜ˆå€¼ï¼ˆé‡åˆåº¦è¿‡é«˜ï¼‰ï¼Œé‚£ä¹ˆå°±å°†è¯¥æ¡†å‰”é™¤ï¼›ç„¶åå¯¹å‰©ä½™çš„æ£€æµ‹æ¡†é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°å¤„ç†å®Œæ‰€æœ‰çš„æ£€æµ‹æ¡†ã€‚Yoloé¢„æµ‹è¿‡ç¨‹ä¹Ÿéœ€è¦ç”¨åˆ°NMSç®—æ³•ã€‚ æ»‘åŠ¨çª—å£ä¸CNNæ»‘åŠ¨çª—å£ä»‹ç»é‡‡ç”¨æ»‘åŠ¨çª—å£çš„ç›®æ ‡æ£€æµ‹ç®—æ³•æ€è·¯éå¸¸ç®€å•ï¼Œå®ƒå°†æ£€æµ‹é—®é¢˜è½¬åŒ–ä¸ºäº†å›¾åƒåˆ†ç±»é—®é¢˜ã€‚å…¶åŸºæœ¬åŸç†å°±æ˜¯é‡‡ç”¨ä¸åŒå¤§å°å’Œæ¯”ä¾‹ï¼ˆå®½é«˜æ¯”ï¼‰çš„çª—å£åœ¨æ•´å¼ å›¾ç‰‡ä¸Šä»¥ä¸€å®šçš„æ­¥é•¿è¿›è¡Œæ»‘åŠ¨ï¼Œç„¶åå¯¹è¿™äº›çª—å£å¯¹åº”çš„åŒºåŸŸåšå›¾åƒåˆ†ç±»ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°å¯¹æ•´å¼ å›¾ç‰‡çš„æ£€æµ‹äº† ç¼ºç‚¹ä½†æ˜¯è¿™ä¸ªæ–¹æ³•æœ‰è‡´å‘½çš„ç¼ºç‚¹ï¼Œå°±æ˜¯ä½ å¹¶ä¸çŸ¥é“è¦æ£€æµ‹çš„ç›®æ ‡å¤§å°æ˜¯ä»€ä¹ˆè§„æ¨¡ï¼Œæ‰€ä»¥ä½ è¦è®¾ç½®ä¸åŒå¤§å°å’Œæ¯”ä¾‹çš„çª—å£å»æ»‘åŠ¨ï¼Œè€Œä¸”è¿˜è¦é€‰å–åˆé€‚çš„æ­¥é•¿ã€‚è¿™æ ·ä¼šäº§ç”Ÿå¾ˆå¤šçš„å­åŒºåŸŸï¼Œå¹¶ä¸”éƒ½è¦ç»è¿‡åˆ†ç±»å™¨å»åšé¢„æµ‹ï¼Œè¿™éœ€è¦å¾ˆå¤§çš„è®¡ç®—é‡ï¼Œæ‰€ä»¥ä½ çš„åˆ†ç±»å™¨ä¸èƒ½å¤ªå¤æ‚ï¼Œå› ä¸ºè¦ä¿è¯é€Ÿåº¦ã€‚ CNNå¯ä»¥ä½¿ç”¨CNNå®ç°æ›´é«˜æ•ˆçš„æ»‘åŠ¨çª—å£æ–¹æ³• ä¸€ç§å…¨å·ç§¯çš„æ–¹æ³•ï¼Œç®€å•æ¥è¯´å°±æ˜¯ç½‘ç»œä¸­ç”¨å·ç§¯å±‚ä»£æ›¿äº†å…¨è¿æ¥å±‚ è¾“å…¥å›¾ç‰‡å¤§å°æ˜¯16x16ï¼Œç»è¿‡ä¸€ç³»åˆ—å·ç§¯æ“ä½œï¼Œæå–äº†2x2çš„ç‰¹å¾å›¾ï¼Œä½†æ˜¯è¿™ä¸ª2x2çš„å›¾ä¸Šæ¯ä¸ªå…ƒç´ éƒ½æ˜¯å’ŒåŸå›¾æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œè¿™ä¸å°±æ˜¯ç›¸å½“äºåœ¨åŸå›¾ä¸Šåšå¤§å°ä¸º14x14çš„çª—å£æ»‘åŠ¨ï¼Œä¸”æ­¥é•¿ä¸º2ï¼Œå…±äº§ç”Ÿ4ä¸ªå­åŒºåŸŸã€‚ ä¹‹æ‰€CNNå¯ä»¥å®ç°è¿™æ ·çš„æ•ˆæœæ˜¯å› ä¸ºå·ç§¯æ“ä½œçš„ç‰¹æ€§ï¼Œå°±æ˜¯å›¾ç‰‡çš„ç©ºé—´ä½ç½®ä¿¡æ¯çš„ä¸å˜æ€§ï¼Œå°½ç®¡å·ç§¯è¿‡ç¨‹ä¸­å›¾ç‰‡å¤§å°å‡å°‘ï¼Œä½†æ˜¯ä½ç½®å¯¹åº”å…³ç³»è¿˜æ˜¯ä¿å­˜çš„ã€‚ ç¼ºç‚¹å°½ç®¡å¯ä»¥å‡å°‘æ»‘åŠ¨çª—å£çš„è®¡ç®—é‡ï¼Œä½†æ˜¯åªæ˜¯é’ˆå¯¹ä¸€ä¸ªå›ºå®šå¤§å°ä¸æ­¥é•¿çš„çª—å£ yoloå¦‚ä½•åšçš„æ€æƒ³ç›´æ¥å°†åŸå§‹å›¾ç‰‡åˆ†å‰²æˆäº’ä¸é‡åˆçš„å°æ–¹å—ï¼Œç„¶åé€šè¿‡å·ç§¯æœ€åç”Ÿäº§è¿™æ ·å¤§å°çš„ç‰¹å¾å›¾ã€‚å¯ä»¥è®¤ä¸ºç‰¹å¾å›¾çš„æ¯ä¸ªå…ƒç´ ä¹Ÿæ˜¯å¯¹åº”åŸå§‹å›¾ç‰‡çš„ä¸€ä¸ªå°æ–¹å—ï¼Œç„¶åç”¨æ¯ä¸ªå…ƒç´ æ¥å¯ä»¥é¢„æµ‹é‚£äº›ä¸­å¿ƒç‚¹åœ¨è¯¥å°æ–¹æ ¼å†…çš„ç›®æ ‡ã€‚ å…·ä½“ç‚¹çš„å…·ä½“æ¥è¯´ï¼ŒYoloçš„CNNç½‘ç»œå°†è¾“å…¥çš„å›¾ç‰‡åˆ†å‰²æˆS*Sä¸ªå•å…ƒæ ¼ï¼Œç„¶åæ¯ä¸ªå•å…ƒæ ¼è´Ÿè´£å»æ£€æµ‹é‚£äº›ä¸­å¿ƒç‚¹è½åœ¨è¯¥æ ¼å­å†…çš„ç›®æ ‡ æ¯ä¸ªå•å…ƒæ ¼ä¼šé¢„æµ‹ Bä¸ªè¾¹ç•Œæ¡†ï¼ˆbounding boxï¼‰ä»¥åŠè¾¹ç•Œæ¡†çš„ç½®ä¿¡åº¦ï¼ˆconfidence score) ç½®ä¿¡åº¦æ‰€è°“ç½®ä¿¡åº¦å…¶å®åŒ…å«ä¸¤ä¸ªæ–¹é¢ï¼Œä¸€æ˜¯è¿™ä¸ªè¾¹ç•Œæ¡†å«æœ‰ç›®æ ‡çš„å¯èƒ½æ€§å¤§å°ï¼ŒäºŒæ˜¯è¿™ä¸ªè¾¹ç•Œæ¡†çš„å‡†ç¡®åº¦ã€‚ å«æœ‰ç›®æ ‡çš„å¯èƒ½æ€§å¤§å°è®°ä¸º ï¼Œå½“è¯¥è¾¹ç•Œæ¡†æ˜¯èƒŒæ™¯æ—¶ï¼ˆå³ä¸åŒ…å«ç›®æ ‡ï¼‰ï¼Œæ­¤æ—¶ ã€‚è€Œå½“è¯¥è¾¹ç•Œæ¡†åŒ…å«ç›®æ ‡æ—¶ï¼Œ è¾¹ç•Œæ¡†çš„å‡†ç¡®åº¦å¯ä»¥ç”¨é¢„æµ‹æ¡†ä¸å®é™…æ¡†ï¼ˆground truthï¼‰çš„IOUï¼ˆintersection over unionï¼Œäº¤å¹¶æ¯”ï¼‰æ¥è¡¨å¾ï¼Œè®°ä¸º ã€‚ å› æ­¤ç½®ä¿¡åº¦å¯ä»¥å®šä¹‰ä¸º è¾“å‡ºè§£é‡Šè¾¹ç•Œæ¡†çš„å¤§å°ä¸ä½ç½®å¯ä»¥ç”¨4ä¸ªå€¼æ¥è¡¨å¾ï¼š ï¼Œå…¶ä¸­ æ˜¯è¾¹ç•Œæ¡†çš„ä¸­å¿ƒåæ ‡ï¼Œè€Œ å’Œ æ˜¯è¾¹ç•Œæ¡†çš„å®½ä¸é«˜ è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œä¸­å¿ƒåæ ‡çš„é¢„æµ‹å€¼ æ˜¯ç›¸å¯¹äºæ¯ä¸ªå•å…ƒæ ¼å·¦ä¸Šè§’åæ ‡ç‚¹çš„åç§»å€¼ï¼Œå¹¶ä¸”å•ä½æ˜¯ç›¸å¯¹äºå•å…ƒæ ¼å¤§å°çš„ï¼Œå•å…ƒæ ¼çš„åæ ‡å®šä¹‰å¦‚å›¾6æ‰€ç¤ºã€‚è€Œè¾¹ç•Œæ¡†çš„ å’Œ é¢„æµ‹å€¼æ˜¯ç›¸å¯¹äºæ•´ä¸ªå›¾ç‰‡çš„å®½ä¸é«˜çš„æ¯”ä¾‹ï¼Œè¿™æ ·4ä¸ªå…ƒç´ çš„å¤§å°åº”è¯¥åœ¨ èŒƒå›´ã€‚ æ€»è¾“å‡ºä¸€éƒ¨åˆ†æ¯ä¸ªè¾¹ç•Œæ¡†çš„é¢„æµ‹å€¼å®é™…ä¸ŠåŒ…å«5ä¸ªå…ƒç´ ï¼š ï¼Œå…¶ä¸­å‰4ä¸ªè¡¨å¾è¾¹ç•Œæ¡†çš„å¤§å°ä¸ä½ç½®ï¼Œè€Œæœ€åä¸€ä¸ªå€¼æ˜¯ç½®ä¿¡åº¦ã€‚ å¦ä¸€éƒ¨åˆ†ï¼ˆåˆ†ç±»é—®é¢˜ï¼‰æ¯ä¸€ä¸ªå•å…ƒæ ¼å…¶è¿˜è¦ç»™å‡ºé¢„æµ‹å‡º ä¸ªç±»åˆ«æ¦‚ç‡å€¼ï¼Œä½†yolo1æ¯ä¸ªå•å…ƒæ ¼åªé¢„æµ‹ä¸€ä¸ªç±»åˆ«ã€‚åæ¥çš„ç‰ˆæœ¬ä¼šæœ‰æ”¹è¿›ï¼Œæš‚æ—¶ä¸æã€‚ æ‰€ä»¥ä¸€ä¸ªå•å…ƒæ ¼ä¼šæœ‰ä¸ªå€¼ æ€»çš„S*Sä¸ªä¼šæœ‰ ä¸ªå€¼","categories":[{"name":"Yoloå­¦ä¹ ","slug":"Yoloå­¦ä¹ ","permalink":"http://example.com/categories/Yolo%E5%AD%A6%E4%B9%A0/"}],"tags":[]},{"title":"yolov1 å…·ä½“ç½‘ç»œç»“æ„","slug":"Yoloå­¦ä¹ /yolo1 å…·ä½“ç½‘ç»œç»“æ„","date":"2025-08-12T08:34:27.000Z","updated":"2025-08-24T18:53:10.000Z","comments":true,"path":"wiki/Yoloå­¦ä¹ /yolo1 å…·ä½“ç½‘ç»œç»“æ„/","permalink":"http://example.com/wiki/Yolo%E5%AD%A6%E4%B9%A0/yolo1%20%E5%85%B7%E4%BD%93%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84/","excerpt":"","text":"å¤§ä½“ç»“æ„Yoloé‡‡ç”¨å·ç§¯ç½‘ç»œæ¥æå–ç‰¹å¾ï¼Œç„¶åä½¿ç”¨å…¨è¿æ¥å±‚æ¥å¾—åˆ°é¢„æµ‹å€¼ã€‚ å·ç§¯å±‚ï¼šä¸»è¦ä½¿ç”¨1x1å·ç§¯æ¥åšchannle reductionï¼Œç„¶åç´§è·Ÿ3x3å·ç§¯ã€‚ å·ç§¯å±‚å’Œå…¨è¿æ¥å±‚ï¼Œé‡‡ç”¨Leaky ReLUæ¿€æ´»å‡½æ•°ï¼š ä½†æ˜¯æœ€åä¸€å±‚å´é‡‡ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°ã€‚ ç›´æ¥ä¸Šå›¾ è¿™é‡Œæˆ‘æ²¡çœ‹æ‡‚æœ€åä¸€ä¸ªä¸ºä»€ä¹ˆä»ä¸€æ¡åˆå˜æˆäº†ä¸€å—ã€‚ è¾“å‡ºçš„å…·ä½“è§£é‡Š å…³äºè®­ç»ƒYoloç®—æ³•å°†ç›®æ ‡æ£€æµ‹çœ‹æˆå›å½’é—®é¢˜ï¼Œæ‰€ä»¥é‡‡ç”¨çš„æ˜¯å‡æ–¹å·®æŸå¤±å‡½æ•°ã€‚ æƒé‡éƒ¨åˆ†å¯¹ä¸åŒçš„éƒ¨åˆ†é‡‡ç”¨äº†ä¸åŒçš„æƒé‡å€¼ã€‚ é¦–å…ˆåŒºåˆ†å®šä½è¯¯å·®å’Œåˆ†ç±»è¯¯å·®ã€‚ å®šä½è¯¯å·®å³è¾¹ç•Œæ¡†åæ ‡é¢„æµ‹è¯¯å·®ï¼Œé‡‡ç”¨è¾ƒå¤§çš„æƒé‡ ã€‚ åˆ†ç±»è¯¯å·®ç„¶åå…¶åŒºåˆ†ä¸åŒ…å«ç›®æ ‡çš„è¾¹ç•Œæ¡†ä¸å«æœ‰ç›®æ ‡çš„è¾¹ç•Œæ¡†çš„ç½®ä¿¡åº¦ï¼Œå¯¹äºå‰è€…ï¼Œé‡‡ç”¨è¾ƒå°çš„æƒé‡å€¼ ï¼Œå…¶å®ƒæƒé‡å€¼å‡è®¾ä¸º1ã€‚ è¯¯å·®éƒ¨åˆ†é‡‡ç”¨å‡æ–¹è¯¯å·®ï¼Œå…¶åŒç­‰å¯¹å¾…å¤§å°ä¸åŒçš„è¾¹ç•Œæ¡†ï¼Œ ä½†æ˜¯å®é™…ä¸Šè¾ƒå°çš„è¾¹ç•Œæ¡†çš„åæ ‡è¯¯å·®åº”è¯¥è¦æ¯”è¾ƒå¤§çš„è¾¹ç•Œæ¡†è¦æ›´æ•æ„Ÿã€‚ä¸ºäº†ä¿è¯è¿™ä¸€ç‚¹ï¼Œå°†ç½‘ç»œçš„è¾¹ç•Œæ¡†çš„å®½ä¸é«˜é¢„æµ‹æ”¹ä¸ºå¯¹å…¶å¹³æ–¹æ ¹çš„é¢„æµ‹ï¼Œå³é¢„æµ‹å€¼å˜ä¸º ã€‚ å¦å¤–ç”±äºæ¯ä¸ªå•å…ƒæ ¼é¢„æµ‹å¤šä¸ªè¾¹ç•Œæ¡†ã€‚ä½†æ˜¯å…¶å¯¹åº”ç±»åˆ«åªæœ‰ä¸€ä¸ªã€‚é‚£ä¹ˆåœ¨è®­ç»ƒæ—¶ï¼Œå¦‚æœè¯¥å•å…ƒæ ¼å†…ç¡®å®å­˜åœ¨ç›®æ ‡ï¼Œé‚£ä¹ˆåªé€‰æ‹©ä¸ground truthçš„IOUæœ€å¤§çš„é‚£ä¸ªè¾¹ç•Œæ¡†æ¥è´Ÿè´£é¢„æµ‹è¯¥ç›®æ ‡ï¼Œè€Œå…¶å®ƒè¾¹ç•Œæ¡†è®¤ä¸ºä¸å­˜åœ¨ç›®æ ‡ã€‚ å¥½å¤„è¿™æ ·è®¾ç½®çš„ä¸€ä¸ªç»“æœå°†ä¼šä½¿ä¸€ä¸ªå•å…ƒæ ¼å¯¹åº”çš„è¾¹ç•Œæ¡†æ›´åŠ ä¸“ä¸šåŒ–ï¼Œå…¶å¯ä»¥åˆ†åˆ«é€‚ç”¨ä¸åŒå¤§å°ï¼Œä¸åŒé«˜å®½æ¯”çš„ç›®æ ‡ï¼Œä»è€Œæå‡æ¨¡å‹æ€§èƒ½ã€‚ ç¼ºç‚¹å¦‚æœä¸€ä¸ªå•å…ƒæ ¼å†…å­˜åœ¨å¤šä¸ªç›®æ ‡æ€ä¹ˆåŠï¼Œå…¶å®è¿™æ—¶å€™Yoloç®—æ³•å°±åªèƒ½é€‰æ‹©å…¶ä¸­ä¸€ä¸ªæ¥è®­ç»ƒ æ³¨æ„ï¼šå¯¹äºä¸å­˜åœ¨å¯¹åº”ç›®æ ‡çš„è¾¹ç•Œæ¡†ï¼Œå…¶è¯¯å·®é¡¹å°±æ˜¯åªæœ‰ç½®ä¿¡åº¦ï¼Œåæ ‡é¡¹è¯¯å·®æ˜¯æ²¡æ³•è®¡ç®—çš„ã€‚è€Œåªæœ‰å½“ä¸€ä¸ªå•å…ƒæ ¼å†…ç¡®å®å­˜åœ¨ç›®æ ‡æ—¶ï¼Œæ‰è®¡ç®—åˆ†ç±»è¯¯å·®é¡¹ï¼Œå¦åˆ™è¯¥é¡¹ä¹Ÿæ˜¯æ— æ³•è®¡ç®—çš„ã€‚ æœ€ç»ˆçš„æŸå¤±å‡½æ•°è®¡ç®—å¦‚ä¸‹ï¼š å…³äºé¢„æµ‹è¿™é‡Œæˆ‘ä»¬ä¸è€ƒè™‘batchï¼Œè®¤ä¸ºåªæ˜¯é¢„æµ‹ä¸€å¼ è¾“å…¥å›¾ç‰‡ã€‚æ ¹æ®å‰é¢çš„åˆ†æï¼Œæœ€ç»ˆçš„ç½‘ç»œè¾“å‡ºæ˜¯ ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å°†å…¶åˆ†å‰²æˆä¸‰ä¸ªéƒ¨åˆ† ç±»åˆ«æ¦‚ç‡éƒ¨åˆ†ä¸º ç½®ä¿¡åº¦éƒ¨åˆ†ä¸º ç½®ä¿¡åº¦éƒ¨åˆ†ä¸º ç„¶åå°†å‰ä¸¤é¡¹ç›¸ä¹˜å¯ä»¥å¾—åˆ°ç±»åˆ«ç½®ä¿¡åº¦å€¼ä¸º è¿™é‡Œæ€»å…±é¢„æµ‹äº† ä¸ªè¾¹ç•Œæ¡†ã€‚ æœ‰ä¸¤ç§å¤„ç†æ–¹æ³•ç¬¬ä¸€ç§ç­–ç•¥é¦–å…ˆï¼Œå¯¹äºæ¯ä¸ªé¢„æµ‹æ¡†æ ¹æ®ç±»åˆ«ç½®ä¿¡åº¦é€‰å–ç½®ä¿¡åº¦æœ€å¤§çš„é‚£ä¸ªç±»åˆ«ä½œä¸ºå…¶é¢„æµ‹æ ‡ç­¾ ç»è¿‡è¿™å±‚å¤„ç†æˆ‘ä»¬å¾—åˆ°å„ä¸ªé¢„æµ‹æ¡†çš„é¢„æµ‹ç±»åˆ«åŠå¯¹åº”çš„ç½®ä¿¡åº¦å€¼ï¼Œå…¶å¤§å°éƒ½æ˜¯ ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¼šè®¾ç½®ç½®ä¿¡åº¦é˜ˆå€¼ï¼Œå°±æ˜¯å°†ç½®ä¿¡åº¦å°äºè¯¥é˜ˆå€¼çš„boxè¿‡æ»¤æ‰ï¼Œæ‰€ä»¥ç»è¿‡è¿™å±‚å¤„ç†ï¼Œå‰©ä½™çš„æ˜¯ç½®ä¿¡åº¦æ¯”è¾ƒé«˜çš„é¢„æµ‹æ¡†ã€‚ æœ€åå†å¯¹è¿™äº›é¢„æµ‹æ¡†ä½¿ç”¨NMSç®—æ³•ã€‚ ç¬¬äºŒç§ç­–ç•¥å…ˆä½¿ç”¨NMSï¼Œç„¶åå†ç¡®å®šå„ä¸ªboxçš„ç±»åˆ«ï¼Œ å¯¹äº98ä¸ªboxesï¼Œé¦–å…ˆå°†å°äºç½®ä¿¡åº¦é˜ˆå€¼çš„å€¼å½’0ï¼Œç„¶ååˆ†ç±»åˆ«åœ°å¯¹ç½®ä¿¡åº¦å€¼é‡‡ç”¨NMSï¼Œè¿™é‡ŒNMSå¤„ç†ç»“æœä¸æ˜¯å‰”é™¤ï¼Œè€Œæ˜¯å°†å…¶ç½®ä¿¡åº¦å€¼å½’ä¸º0ã€‚æœ€åæ‰æ˜¯ç¡®å®šå„ä¸ªboxçš„ç±»åˆ«ï¼Œå½“å…¶ç½®ä¿¡åº¦å€¼ä¸ä¸º0æ—¶æ‰åšå‡ºæ£€æµ‹ç»“æœè¾“å‡ºã€‚ æˆ‘è¯»åˆ°çš„æ–‡ç« è¯´ï¼šè¿™ä¸ªç­–ç•¥ä¸æ˜¯å¾ˆç›´æ¥ï¼Œä½†æ˜¯è²Œä¼¼Yoloæºç å°±æ˜¯è¿™æ ·åšçš„ã€‚Yoloè®ºæ–‡é‡Œé¢è¯´NMSç®—æ³•å¯¹Yoloçš„æ€§èƒ½æ˜¯å½±å“å¾ˆå¤§çš„ï¼Œæ‰€ä»¥å¯èƒ½è¿™ç§ç­–ç•¥å¯¹Yoloæ›´å¥½ã€‚ä½†æ˜¯æˆ‘æµ‹è¯•äº†æ™®é€šçš„å›¾ç‰‡æ£€æµ‹ï¼Œä¸¤ç§ç­–ç•¥ç»“æœæ˜¯ä¸€æ ·çš„ã€‚","categories":[{"name":"Yoloå­¦ä¹ ","slug":"Yoloå­¦ä¹ ","permalink":"http://example.com/categories/Yolo%E5%AD%A6%E4%B9%A0/"}],"tags":[]},{"title":"anchor boxï¼ˆå…ˆéªŒæ¡†ï¼‰","slug":"Yoloå­¦ä¹ /anchor boxes","date":"2025-08-10T08:34:27.000Z","updated":"2025-08-24T18:32:30.000Z","comments":true,"path":"wiki/Yoloå­¦ä¹ /anchor boxes/","permalink":"http://example.com/wiki/Yolo%E5%AD%A6%E4%B9%A0/anchor%20boxes/","excerpt":"","text":"anchor boxï¼ˆå…ˆéªŒæ¡†ï¼‰anchor ï¼ˆé”š; ç»™ä»¥å®‰å…¨æ„Ÿçš„äºº(æˆ–ç‰©); ç²¾ç¥æ”¯æŸ±; é¡¶æ¢æŸ±;ï¼‰ ä¸ºä»€ä¹ˆå¯¹è±¡æ£€æµ‹ä¸­å­˜åœ¨ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ¯ä¸ªæ ¼å­åªèƒ½é¢„æµ‹ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœæƒ³è®©ä¸€ä¸ªæ ¼å­æ£€æµ‹å‡ºå¤šä¸ªå¯¹è±¡ï¼Œç”¨anchor box ä»¥å‰çš„åšæ³•å‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·ä¸€å¼ å›¾ç‰‡ï¼Œå¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä½¿ç”¨3x3çš„ç½‘æ ¼ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°ï¼Œè¡Œäººå’Œæ±½è½¦çš„ä¸­å¿ƒå‡ ä¹åœ¨åŒä¸€ä¸ªç½‘æ ¼ï¼Œç„¶è€Œæˆ‘ä»¬ä»¥å‰çš„æ–¹æ³•ä¸€ä¸ªæ ¼å­åªèƒ½é¢„æµ‹ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”å¯¹äºyè¾“å‡ºçš„çš„å‘é‡é‡ğ‘¦ &#x3D; [ğ‘ğ‘ ğ‘ğ‘¥ ğ‘ğ‘¦ ğ‘â„ ğ‘ğ‘¤ ğ‘1 ğ‘2 ğ‘3 ]ï¼Œä½ å¯ä»¥æ£€æµ‹è¿™ä¸‰ä¸ªç±»åˆ«ï¼Œè¡Œäººã€æ±½è½¦å’Œæ‘©æ‰˜è½¦ï¼Œå®ƒå°†æ— æ³•è¾“å‡ºæ£€æµ‹ç»“æœï¼Œæ‰€ä»¥æˆ‘å¿…é¡»ä»ä¸¤ä¸ªæ£€æµ‹ç»“æœä¸­é€‰ä¸€ä¸ªï¼Œè¿™ä¾¿å½±å“äº†æ¨¡å‹æ€§èƒ½ï¼Œå¯¼è‡´ä¸€äº›å¯¹è±¡è¢«ä¸¢å¼ƒæ— æ³•æ£€æµ‹å‡ºæ¥ã€‚ anchor box å¼•å…¥ é¢„å…ˆå®šä¹‰ä¸¤ä¸ªä¸åŒå½¢çŠ¶çš„ anchor boxï¼Œæˆ–è€… anchor box å½¢çŠ¶ ä¸€èˆ¬æ¥è¯´ï¼Œå¯èƒ½ä¼šç”¨æ›´å¤šçš„ anchor boxï¼Œå¯èƒ½è¦ 5 ä¸ªç”šè‡³æ›´å¤šï¼Œä¸ºä»‹ç»æ–¹ä¾¿å°±ç”¨ä¸¤ä¸ª anchor box å®šä¹‰ç±»åˆ«æ ‡ç­¾ï¼Œç”¨çš„å‘é‡ä¸å†æ˜¯ä¸‹é¢è¿™ä¸ªï¼š[ğ‘ğ‘ ğ‘ğ‘¥ ğ‘ğ‘¦ ğ‘â„ ğ‘ğ‘¤ ğ‘1 ğ‘2 ğ‘3]ğ‘‡ è€Œæ˜¯è¾“å‡ºé‡å¤ä¸¤æ¬¡ï¼š ğ‘¦ &#x3D; [ğ‘ğ‘ ğ‘ğ‘¥ ğ‘ğ‘¦ ğ‘â„ ğ‘ğ‘¤ ğ‘1 ğ‘2 ğ‘3 ğ‘ğ‘ ğ‘ğ‘¥ ğ‘ğ‘¦ ğ‘â„ ğ‘ğ‘¤ ğ‘1 ğ‘2 ğ‘3]ğ‘‡ å‰ä¸€åŠæ˜¯box1åä¸€åŠæ˜¯box2 è¡Œäººä¸€èˆ¬ç¬¦åˆanchor box1å½¢çŠ¶ï¼Œæ‰€ä»¥ç”¨anchor box1æ¥é¢„æµ‹è¡Œäººä¼šè¾¾åˆ°å¾ˆå¥½çš„æ•ˆæœï¼Œè¿™ä¹ˆç¼–ç ğ‘ğ‘ &#x3D; 1ï¼Œä»£è¡¨æœ‰ä¸ªè¡Œäººï¼Œç”¨ğ‘ğ‘¥,ğ‘ğ‘¦,ğ‘â„å’Œğ‘ğ‘¤æ¥ç¼–ç åŒ…ä½è¡Œäººçš„è¾¹ç•Œæ¡†ï¼Œç„¶åç”¨ğ‘1,ğ‘2,ğ‘3(ğ‘1 &#x3D; 1,ğ‘2 &#x3D; 0,ğ‘3 &#x3D; 0)æ¥è¯´æ˜è¿™ä¸ªå¯¹è±¡æ˜¯ä¸ªè¡Œäººã€‚æ±½è½¦ä¸€èˆ¬æ˜¯box2ï¼Œæ–¹å¼åŒç† æ–‡ç« æ²¡è¯´ç¼–ç å®Œä¸€éƒ¨åˆ†åå‰©ä¸‹çš„æ€ä¹ˆå¤„ç† æ€»ç»“æ‰€ä»¥ï¼Œæ€»çš„æ¥è¯´ï¼Œanchor boxæ˜¯è¿™ä¹ˆæ¥åšçš„ï¼Œç°åœ¨æ¯ä¸ªå¯¹è±¡å’Œä»¥å‰ä¸€æ ·æ ¹æ®ä¸­å¿ƒç‚¹åˆ†é…åˆ°ä¸€ä¸ªæ ¼å­ä¸­ï¼Œç„¶åçœ‹å’Œæ¯ä¸ªanchor boxçš„IoUï¼ˆäº¤å¹¶æ¯”ï¼‰ï¼Œé€‰æ‹©IoUæœ€é«˜çš„é‚£ä¸ªï¼Œç”¨è¿™ä¸ªanchor boxæ¥è¿›è¡Œé¢„æµ‹ã€‚è¾“å‡ºyçš„ç»´åº¦æ˜¯nxnxmxcï¼ˆnä¸ºå›¾ç‰‡åˆ†æˆnxnä»½ï¼Œmä¸ºanchor boxæ•°é‡ï¼Œcä¸ºclassç±»åˆ«æ•°ï¼‰ ä¸è¶³1.ä¸¤ä¸ª anchor boxï¼Œä½†åœ¨åŒä¸€ä¸ªæ ¼å­ä¸­æœ‰ä¸‰ä¸ªå¯¹è±¡ï¼Œè¿™ç§æƒ…å†µç®—æ³•å¤„ç†ä¸å¥½ï¼Œä½ å¸Œæœ›è¿™ç§æƒ…å†µä¸ä¼šå‘ç”Ÿï¼Œä½†å¦‚æœçœŸçš„å‘ç”Ÿäº†ï¼Œè¿™ä¸ªç®—æ³•å¹¶æ²¡æœ‰å¾ˆå¥½çš„å¤„ç†åŠæ³• 2.ä¸¤ä¸ªå¯¹è±¡éƒ½åˆ†é…åˆ°ä¸€ä¸ªæ ¼å­ä¸­ï¼Œè€Œä¸”å®ƒä»¬çš„ anchor box å½¢çŠ¶ä¹Ÿä¸€æ ·ï¼Œä¹Ÿä¸å¥½åŠ çœ‹æ–‡ç« è¯´å…¶å®è¿™ä¸¤ç§æƒ…å†µå¾ˆå°‘å‡ºç°ï¼Œç‰¹åˆ«æ˜¯å¦‚æœä½ ç”¨çš„æ˜¯ 19Ã—19 ç½‘æ ¼è€Œä¸æ˜¯3Ã—3 çš„ç½‘æ ¼ æ€ä¹ˆé€‰boxï¼Ÿ1.ä¸€èˆ¬æ‰‹å·¥æŒ‡å®šanchor boxå½¢çŠ¶ï¼Œæ ¹æ®è¦æ£€æµ‹çš„å¯¹è±¡ï¼ŒæŒ‡å®šæœ‰é’ˆå¯¹æ€§åœ°anchor boxï¼Œå¯é€‰æ‹©5-10ä¸ªanchor boxï¼Œä½¿å…¶å°½å¯èƒ½è¦†ç›–åˆ°ä¸åŒå½¢çŠ¶ã€‚2.ä½¿ç”¨K-meansèšç±»ç®—æ³•è·å¾—anchor boxã€‚","categories":[{"name":"Yoloå­¦ä¹ ","slug":"Yoloå­¦ä¹ ","permalink":"http://example.com/categories/Yolo%E5%AD%A6%E4%B9%A0/"}],"tags":[]}],"categories":[{"name":"Yoloå­¦ä¹ ","slug":"Yoloå­¦ä¹ ","permalink":"http://example.com/categories/Yolo%E5%AD%A6%E4%B9%A0/"}],"tags":[]}